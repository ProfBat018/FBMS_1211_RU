# Тема урока. DockerFiles

Докерфайл - это текстовый файл, который содержит инструкции, которые Docker может использовать для автоматического создания образа.


Кстати расширения у него нет, как у .gitiignore файла.

## Синтаксис
Докерфайлы состоят из команд, которые Docker будет выполнять последовательно, чтобы создать образ.

Каждая строка в докерфайле это новый слой образа, то есть layer. Каждый слой образа создается из предыдущего слоя, но с изменениями, которые указаны в команде и кешируется. Это позволяет ускорить процесс сборки образа, так как при изменении команды, которая создает слой, Docker пересобирает только те слои, которые на него завязаны.

Команды в докерфайле не зависят от регистра, но обычно пишутся в верхнем регистре, чтобы их было легче отличать от других строк.

Комментарии в докерфайле начинаются с символа #.

```dockerfile
# Синтаксис создания .NET Core образа

# Образ, который будет использоваться в качестве основы для создания нового образа

FROM mcr.microsoft.com/dotnet/core/sdk:3.1 AS build-env

# Копируем файлы проекта в образ

COPY . /app

# Устанавливаем рабочую директорию

WORKDIR /app

# Выполняем сборку проекта

RUN dotnet publish -c Release -o out

# Образ, который будет использоваться в качестве основы для создания нового образа
```

То что вы видите выше, это пример докерфайла, который используется для создания образа приложения на .NET Core. 

Каждая строка в докерфайле это команда, которая выполняется в контексте образа, и каждая строка это новый слой образа.

Подробнее про слои. 

Мы должны создавать как можно меньше слоев, чтобы уменьшить размер образа. Поэтому, если мы хотим выполнить несколько команд, то мы можем использовать один слой для этого. Для этого мы можем использовать оператор \, который позволяет разбить команду на несколько строк.

```dockerfile

# \ - оператор переноса строки

RUN dotnet publish -c Release -o out \
    && apt-get update \
    && apt-get install -y \
        git \
        vim \
        nano \
    && rm -rf /var/lib/apt/lists/*

```


## Команды Docker CLI
```cmd

# Сборка образа
docker build -t <имя образа> <путь к докерфайлу>

# Сборка образа с указанием тега
docker build -t <имя образа>:<тег> <путь к докерфайлу>

# Сборка образа с указанием тега и контекста
docker build -t <имя образа>:<тег> <путь к докерфайлу> -f <путь к докерфайлу>

# Запуск контейнера
docker run <имя образа>

# Запуск контейнера с указанием имени
docker run --name <имя контейнера> <имя образа>

# Запуск контейнера с указанием имени и удалением после остановки

docker run --name <имя контейнера> --rm <имя образа>

# Запуск контейнера в интерактивном режиме с указанием имени и удалением после остановки

docker run --name <имя контейнера> --rm -it <имя образа>
```

## Что такое интерактивный реежим ? 

Интерактивный режим позволяет взаимодействовать с контейнером, то есть вводить команды в терминал контейнера.



