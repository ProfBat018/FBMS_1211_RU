# Урок №3. 
## Темы урока:
* Docker and OCI
* Namespaces
* Cgroups
* UnionFS
* Docker Engine 
* Dockerfile


## Docker and OCI
С прошлых уроков мы уже знаем что такое `контейнеры` и как они работают. Но как же они реализованы? Для этого нам нужно познакомиться с Docker и OCI.

`OCI` - Open Container Initiative

OCI - это некоммерческая организация, которая разрабатывает открытые стандарты для контейнеров. Она была создана в 2015 году и включает в себя таких участников как Docker, Google, Microsoft, Red Hat, IBM и многих других. OCI разрабатывает два стандарта: Runtime Specification и Image Specification.

`Runtime Specification` - это спецификация, которая описывает как должен работать контейнер. Она описывает как должен работать контейнер, какие должны быть у него namespace, какие cgroups и т.д.

`Image Specification` - это спецификация, которая описывает как должен выглядеть образ контейнера. Она описывает как должен выглядеть образ, какие должны быть у него слои, какие должны быть у него метаданные и т.д.



## Namespaces
`Namespaces` - это механизм ядра Linux, который позволяет изолировать процессы друг от друга. В Linux есть 7 типов namespaces:
* `PID` - Process изолирует процессы друг от друга. Каждый процесс внутри контейнера имеет свой уникальный PID, который не пересекается с PID процессов вне контейнера.
* `Network` - изолирует сетевые интерфейсы, таблицы маршрутизации, правила файрвола и т.д. Каждый контейнер имеет свой уникальный набор сетевых интерфейсов, таблиц маршрутизации и т.д. В будущем мы поговорим подробнее о сетевых интерфейсах, например про IpvNet & MacVnet
* `Mount` - изолирует точки монтирования файловой системы. Каждый контейнер имеет свой уникальный набор точек монтирования.
* `UTS` - изолирует имена хоста и доменное имя. Каждый контейнер имеет свое уникальное имя хоста и доменное имя.
* `IPC` - изолирует межпроцессное взаимодействие. Каждый контейнер имеет свой уникальный набор IPC ресурсов. То есть по факту наши контейнеры не могут общаться друг с другом, потому что они не имеют общих IPC ресурсов.
* `User` - изолирует пользователей и группы. Каждый контейнер имеет свой уникальный набор пользователей и групп.
* `Cgroup` - изолирует ресурсы. Каждый контейнер имеет свой уникальный набор ресурсов.


Если провести параллель с виртуальными машинами, то можно сказать что namespaces - это то же самое что и виртуализация аппаратных ресурсов. То есть виртуальные машины изолируют аппаратные ресурсы, а контейнеры изолируют процессы.

Если провести параллель с программированием, то там мы тоже изолируем классы, структуры, переменные и т.д. То есть в программировании мы изолируем данные, а в контейнерах мы изолируем процессы.

## UnionFS
`UnionFS` - это механизм ядра Linux, который позволяет объединять несколько файловых систем в одну. В Linux есть несколько типов UnionFS:
* `AUFS` - Advanced Multi-Layered Unification Filesystem
* `OverlayFS` - Overlay Filesystem
* `DeviceMapper` - Device Mapper
* `Btrfs` - B-tree File System
* `ZFS` - Z File System

## Docker Engine 

Сама система Docker Engine состоит из нескольких компонентов:
* `Docker Daemon` - это демон, который запускается на хосте и управляет контейнерами. Он отвечает за создание, запуск, остановку и удаление контейнеров. Также он отвечает за создание, загрузку и удаление образов. Демон слушает сокеты и REST API.
* `Docker Client` - это клиент, который запускается на хосте и управляет демоном. Он отвечает за создание, запуск, остановку и удаление контейнеров. Также он отвечает за создание, загрузку и удаление образов. Клиент подключается к демону через сокеты или REST API.
* `Docker Registry` - это реестр, который хранит образы. Он отвечает за загрузку и удаление образов. Также он отвечает за авторизацию и аутентификацию пользователей. Реестр может быть публичным или приватным. Публичный реестр доступен всем, а приватный реестр доступен только авторизованным пользователям.

и все это работает на `Linux`.

